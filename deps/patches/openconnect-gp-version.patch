diff --git a/gpst.c b/gpst.c
index 244aaf04..205bec1d 100644
--- a/gpst.c
+++ b/gpst.c
@@ -650,8 +650,11 @@ static int gpst_get_config(struct openconnect_info *vpninfo)
 
 
 	/* submit getconfig request */
+	char *app_version = vpninfo->csd_ticket ? : (vpninfo->gp_app_version ? : "6.3.0-33");
+	vpn_progress(vpninfo, PRG_DEBUG, _("Using GlobalProtect app version: %s\n"), app_version);
+
 	buf_append(request_body, "client-type=1&protocol-version=p1&internal=no");
-	append_opt(request_body, "app-version", vpninfo->csd_ticket ? : "6.3.0-33");
+	append_opt(request_body, "app-version", app_version);
 	append_opt(request_body, "ipv6-support", vpninfo->disable_ipv6 ? "no" : "yes");
 	append_opt(request_body, "clientos", gpst_os_name(vpninfo));
 	append_opt(request_body, "os-version", vpninfo->platname);
diff --git a/library.c b/library.c
index b5e74e9b..fff28f77 100644
--- a/library.c
+++ b/library.c
@@ -896,6 +896,7 @@ void openconnect_vpninfo_free(struct openconnect_info *vpninfo)
 
 	free(vpninfo->localname);
 	free(vpninfo->useragent);
+	free(vpninfo->gp_app_version);
 	free(vpninfo->authgroup);
 #ifdef HAVE_LIBSTOKEN
 	if (vpninfo->stoken_pin)
@@ -1019,6 +1020,15 @@ int openconnect_set_useragent(struct openconnect_info *vpninfo,
 	return 0;
 }
 
+int openconnect_set_gp_app_version(struct openconnect_info *vpninfo,
+				   const char *gp_app_version)
+{
+	UTF8CHECK(gp_app_version);
+
+	STRDUP(vpninfo->gp_app_version, gp_app_version);
+	return 0;
+}
+
 int openconnect_set_urlpath(struct openconnect_info *vpninfo,
 			    const char *urlpath)
 {
diff --git a/openconnect-internal.h b/openconnect-internal.h
index abf45bbd..85933f4a 100644
--- a/openconnect-internal.h
+++ b/openconnect-internal.h
@@ -786,6 +786,7 @@ struct openconnect_info {
 	int is_dyndns; /* Attempt to redo DNS lookup on each CSTP reconnect */
 	char *useragent;
 	char *version_string;
+	char *gp_app_version;
 
 	const char *quit_reason;
 	const char *delay_tunnel_reason;        /* If non-null, provides a reason why protocol is not yet ready for tunnel setup */
diff --git a/openconnect.h b/openconnect.h
index 136f181a..67fc1283 100644
--- a/openconnect.h
+++ b/openconnect.h
@@ -470,6 +470,9 @@ int openconnect_set_http_proxy(struct openconnect_info *vpninfo,
 int openconnect_set_useragent(struct openconnect_info *vpninfo,
 			      const char *useragent);
 
+int openconnect_set_gp_app_version(struct openconnect_info *vpninfo,
+				   const char *gp_app_version);
+
 int openconnect_passphrase_from_fsid(struct openconnect_info *vpninfo);
 int openconnect_obtain_cookie(struct openconnect_info *vpninfo);
 int openconnect_init_ssl(void);
